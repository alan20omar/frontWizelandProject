<div
    #ulScrollCards class="h-100 position-relative overflow-scroll d-block container-fluid text-center"
    infiniteScroll
    [infiniteScrollContainer]="ulScrollCards"
    [infiniteScrollDistance]="0" 
    [infiniteScrollThrottle]="300"
    (scrolled)="scrollDown()"
>
    <!-- Buscador -->
    <form class="text-center mt-2 col-12">
        <mat-form-field class="searchbar m-2">
            <mat-label>Buscar cartas</mat-label>
            <mat-chip-grid #chipGrid>
                <mat-chip-row *ngFor="let filtroSelect of filtrosSelected" (removed)="remove(filtroSelect)" [title]="filtroSelect">
                    <div class="d-flex align-items-center">
                        <img *ngIf="allfiltersKeys.includes(filtroSelect)" [src]="API_YGO_BASE_URL+'/images/'+filtroSelect+'.png'" [alt]="filtroSelect" class="icon me-0 me-sm-2">
                        <span [class.d-none]="allfiltersKeys.includes(filtroSelect)" class="d-none d-sm-inline">{{filtroSelect}}</span>
                    </div>
                    <button matChipRemove [attr.aria-label]="'remove ' + filtroSelect">
                        <mat-icon>cancel</mat-icon>
                    </button>
                </mat-chip-row>
            </mat-chip-grid>
            <input placeholder="Buscar..." #searchInput [formControl]="cardSearchForm" [matChipInputFor]="chipGrid"
            [matAutocomplete]="auto" [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
            (matChipInputTokenEnd)="add($event)"/>
            <mat-autocomplete #auto="matAutocomplete" (optionSelected)="selected($event)">
                <mat-option *ngFor="let filtro of filtros | async" [value]="filtro">
                    <div class="d-flex align-items-center">
                        <img [src]="API_YGO_BASE_URL+'/images/'+filtro+'.png'" [alt]="filtro" [title]="filtro" class="icon me-2">
                        <span class="d-inline">{{filtro}}</span>
                    </div>
                </mat-option>
            </mat-autocomplete>
        </mat-form-field>
    </form>
    <!-- Cartas filtradas -->
    <div *ngIf="sinRespuesta && !newCards.length" class="col-12">
        <div class="searchbar alert alert-danger mx-auto" role="alert">
            No se encontraron cartas con estas caracteristicas D:
        </div>
    </div>
    <div class="d-flex flex-wrap w-100 justify-content-evenly px-0 px-sm-5 col-12">
        <ng-container *ngFor="let card of newCards">
            <app-card [card]="card" class="mw-100"></app-card>
        </ng-container>
    </div>
    <div class="col-12">
        <button *ngIf="!sinRespuesta" mat-raised-button color="primary" class="mt-3" (click)="scrollDown()">Cargar mas resultados</button>
    </div>
    <div *ngIf="sinRespuesta && newCards.length" class="col-12">
        <div class="searchbar alert alert-info mt-3 mx-auto" role="alert">
            Llegaste al final de la lista! :O
        </div>
    </div>
</div>
